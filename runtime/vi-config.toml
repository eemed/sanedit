#
# Sanedit configuration
#
# Configuration can be overridden using a sanedit-project.toml file in project
# root. The file should be in the same format as this one and
# configuration may be partially updated
#
[editor]

# Large file threshold in bytes
big_file_threshold_bytes = 1048576

# Directories to ignore, when opening files etc.
ignore_directories = [".git", "target"]

# Default shell command
shell = "/bin/bash"

# Shell command to build current project
build_command = ""

# Shell command to run current project
run_command = ""

# Autodetect eol from file
detect_eol = true

# Autodetect indentation from file
detect_indent = true

# Filetype glob patterns
# By default the filetype is the extension of the file
[editor.filetype]
rust = ["*.rs"]
toml = ["**/Cargo.lock"]
markdown = ["*.md"]
yaml = ["*.yml"]

[window]

# Maximum prompt completions to show at once
max_prompt_completions = 10

# Maximum completions to show at once
max_completions = 10
theme = "default"

# Highlight syntax
highlight_syntax = true

# Highlight LSP diagnostics
highlight_diagnostics = true

# Automatically indent lines, and clear them from indent
autoindent = true

# Automatically insert pairs on enter, works only with autoindent
autopair = true

[buffer]

# Default EOL, overridden if detect_eol is set
# Available options:
# LF: Line Feed, U+000A (UTF-8 in hex: 0A)
# VT: Vertical Tab, U+000B (UTF-8 in hex: 0B)
# FF: Form Feed, U+000C (UTF-8 in hex: 0C)
# CR: Carriage Return, U+000D (UTF-8 in hex: 0D)
# CRLF: CR (U+000D) followed by LF (U+000A) (UTF-8 in hex: 0D 0A)
# NEL: Next Line, U+0085 (UTF-8 in hex: C2 85)
# LS: Line Separator, U+2028 (UTF-8 in hex: E2 80 A8)
# PS: Paragraph Separator, U+2029 (UTF-8 in hex: E2 80 A9)
eol = "LF"

# How many spaces for a tab character, note that tab does not always have
# width `tab_width` because tabs are used to align stuff, so it
# is "elastic" calculated tabstop - (col % tabstop).
tabstop = 8

# Indent options, overridden if detect_indent is set
# Available options:
# Space: use spaces
# Tab: use tabs
indent_kind = "Space"

# How many indent characters a single indent should be
indent_amount = 4

[keymaps.snippet]
fallthrough = "insert"
maps = [
    { key = "tab", actions = ["snippet_jump_next"] },
]

[keymaps.insert]
maps = [
    { key = "esc", actions = ["stop_selection", "completion_abort", "goto_layer window"] },
    { key = "left", actions = ["prev_grapheme"] },
    { key = "up", actions = ["prev_line"] },
    { key = "down", actions = ["next_line"] },
    { key = "right", actions = ["next_grapheme"] },
    { key = "backspace", actions = ["remove_grapheme_before_cursor"] },
    { key = "delete", actions = ["remove_grapheme_after_cursor"] },
    { key = "enter", actions = ["insert_newline"] },
    { key = "tab", actions = ["insert_tab"] },
    { key = "btab", actions = ["backtab"] },
]

[keymaps.select]
discard = true
fallthrough = "window"
maps = [
    { key = "i", actions = ["nop"] },
    { key = "x", actions = ["remove_cursor_selections"] },
    { key = "d", actions = ["remove_cursor_selections"] },
    { key = "c", actions = ["remove_cursor_selections", "goto_layer insert"] },
    { key = "esc", actions = ["stop_selection", "goto_layer window"] },
    { key = ".", actions = ["swap_selection_dir"] },

    { key = "K", actions = ["swap_selection_dir", "prev_line", "swap_selection_dir"] },
    { key = "J", actions = ["swap_selection_dir", "next_line", "swap_selection_dir"] },

    { key = "g", actions = ["nop"] },
    { key = "g c", actions = ["toggle_comment_lines"] },
    { key = "I", actions = ["cursors_to_lines_start"] },
    { key = "A", actions = ["cursors_to_lines_end"] },
]

[keymaps.window]
discard = true
maps = [
    { key = "space q", actions = ["quit"] },

    { key = "ctrl+s", actions = ["save"] },
    { key = "ctrl+c", actions = ["copy"] },
    { key = "ctrl+v", actions = ["paste"] },
    { key = "ctrl+x", actions = ["cut"] },
    { key = "ctrl+d", actions = ["scroll_down"] },
    { key = "ctrl+u", actions = ["scroll_up"] },

    { key = "esc", actions = ["cancel"] },
    { key = "y", actions = ["copy"] },
    { key = "p", actions = ["paste"] },
    { key = "i", actions = ["goto_layer insert"] },
    { key = "u", actions = ["undo"] },
    { key = "U", actions = ["redo"] },
    { key = "h", actions = ["prev_grapheme"] },
    { key = "k", actions = ["prev_line"] },
    { key = "j", actions = ["next_line"] },
    { key = "l", actions = ["next_grapheme"] },


    { key = "ctrl+p", actions = ["open_file"] },
    { key = "v", actions = ["start_selection", "next_grapheme", "goto_layer select"] },
    { key = "$", actions = ["end_of_line"] },
    { key = "^", actions = ["start_of_line"] },
    { key = "0", actions = ["first_char_of_line"] },
    { key = "w", actions = ["next_word_start"] },
    { key = "b", actions = ["prev_word_start"] },
    { key = "V", actions = ["select_line", "goto_layer select"] },
    { key = "a", actions = ["next_grapheme", "goto_layer insert"] },
    { key = "A", actions = ["end_of_line", "goto_layer insert"] },
    { key = "I", actions = ["first_char_of_line", "goto_layer insert"] },
    { key = "!", actions = ["shell_command"] },
    { key = ":", actions = ["command_palette"] },
    { key = "/", actions = ["search_forward"] },
    { key = "?", actions = ["search_backward"] },
    { key = "%", actions = ["goto_matching_pair"] },
    { key = "c", actions = ["first_char_of_line", "remove_to_end_of_line", "goto_layer insert"] },
    { key = "d", actions = ["select_line", "swap_selection_dir", "remove_cursor_selections"] },
    { key = "D", actions = ["remove_to_end_of_line"] },
    { key = "x", actions = ["remove_grapheme_after_cursor"] },
    { key = "G", actions = ["end_of_buffer"] },
    { key = "g g", actions = ["start_of_buffer"] },
    { key = "o", actions = ["newline_below", "goto_layer insert"] },
    { key = "O", actions = ["newline_above", "goto_layer insert"] },
    { key = ">", actions = ["indent_line"] },
    { key = "<", actions = ["dedent_line"] },
    { key = "f", actions = ["find_next_char_on_line"] },
    { key = "F", actions = ["find_prev_char_on_line"] },
    { key = ";", actions = ["next_char_on_line"] },
    { key = ",", actions = ["prev_char_on_line"] },
    { key = "n", actions = ["next_search_match"] },
    { key = "N", actions = ["prev_search_match"] },
    { key = "#", actions = ["search_prev_word_under_cursor"] },
    { key = "*", actions = ["search_next_word_under_cursor"] },
    { key = "&", actions = ["align_cursor_columns"] },

    { key = "alt+down", actions = ["new_cursor_to_next_line"] },
    { key = "alt+up", actions = ["new_cursor_to_prev_line"] },
    { key = "alt+d", actions = ["new_cursor_to_next_search_match"] },
    { key = "alt+l", actions = ["new_cursor_to_all_search_matches"] },
    { key = "space b", actions = ["open_buffer"] },
    { key = "space g", actions = ["grep"] },
    { key = "alt+k", actions = ["prev_paragraph"] },
    { key = "alt+j", actions = ["next_paragraph"] },

    { key = "g d", actions = ["goto_definition"] },
    { key = "g r", actions = ["references"] },
    { key = "g R", actions = ["rename"] },
    { key = "space a", actions = ["code_action"] },
    { key = "space f", actions = ["format"] },
    { key = "K", actions = ["hover"] },

    { key = "-", actions = ["show_filetree"] },
    { key = "alt+q", actions = ["show_locations"] },
    { key = "backspace", actions = ["goto_prev_buffer"] },

    { key = "s l", actions = ["select_line",        "goto_layer select"] },
    { key = "s c", actions = ["select_curly",       "goto_layer select"] },
    { key = "s C", actions = ["select_curly_incl",  "goto_layer select"] },
    { key = "s b", actions = ["select_parens",      "goto_layer select"] },
    { key = "s B", actions = ["select_parens_incl", "goto_layer select"] },
    { key = "s r", actions = ["select_square",      "goto_layer select"] },
    { key = "s R", actions = ["select_square_incl", "goto_layer select"] },
    { key = "s a", actions = ["select_angle",       "goto_layer select"] },
    { key = "s A", actions = ["select_angle_incl",  "goto_layer select"] },
    { key = 's "', actions = ["select_double",      "goto_layer select"] },
    { key = "s '", actions = ["select_single",      "goto_layer select"] },
    { key = "s `", actions = ["select_backtick",    "goto_layer select"] },
    { key = "s p", actions = ["select_paragraph",   "goto_layer select"] },
    { key = "s w", actions = ["select_word",        "goto_layer select"] },

    { key = "e", actions = ["next_word_end"] },
    { key = "E", actions = ["prev_word_end"] },

    { key = "f2", actions = ["build_project"] },
    { key = "f3", actions = ["run_project"] },
    { key = "f5", actions = ["reload_window"] },
]

[keymaps.search]
maps = [
    { key = "ctrl+q", actions = ["quit"] },
    { key = "esc", actions = ["prompt_close"] },
    { key = "backspace", actions = ["prompt_remove_grapheme_before_cursor"] },
    { key = "left", actions = ["prompt_prev_grapheme"] },
    { key = "right", actions = ["prompt_next_grapheme"] },
    { key = "enter", actions = ["prompt_confirm"] },
    { key = "up", actions = ["prompt_history_next"] },
    { key = "down", actions = ["prompt_history_prev"] },
    { key = "ctrl+r", actions = ["search_toggle_regex"] },
]


[keymaps.locations]
maps = [
    { key = "alt+q", actions = ["close_locations"] },
    { key = "space q", actions = ["close_locations"] },
    { key = "k", actions = ["prev_loc_entry"] },
    { key = "j", actions = ["next_loc_entry"] },

    { key = "enter", actions = ["goto_loc_entry"] },
    { key = "p", actions = ["select_loc_parent"] },
    { key = "e", actions = ["toggle_all_expand_locs"] },
    # { key = "k", actions = ["keep_locations"] },
    # { key = "r", actions = ["reject_locations"] },

    # { key = "alt+up", actions = ["focus_window"] },

    # { key = "up", actions = ["prev_loc_entry"] },
    # { key = "down", actions = ["next_loc_entry"] },
    # { key = "btab", actions = ["prev_loc_entry"] },
    # { key = "tab", actions = ["next_loc_entry"] },
    # { key = "p", actions = ["select_loc_parent"] },
    # { key = "s", actions = ["toggle_all_expand_locs"] },
    # { key = "k", actions = ["keep_locations"] },
    # { key = "r", actions = ["reject_locations"] },
    # { key = "alt+1", actions = ["focus_window"] },
    # { key = "alt+2", actions = ["show_filetree"] },
    # { key = "alt+3", actions = ["close_locations"] },
]

[keymaps.filetree]
maps = [
    { key = "space q", actions = ["close_filetree"] },
    { key = "enter", actions = ["goto_ft_entry"] },
    { key = "k", actions = ["prev_ft_entry"] },
    { key = "j", actions = ["next_ft_entry"] },
    { key = "h", actions = ["select_ft_parent"] },
    { key = "s", actions = ["ft_goto_current_file"] },

    { key = "c", actions = ["ft_new_file"] },
    { key = "d", actions = ["ft_delete_file"] },

    # { key = "alt+right", actions = ["focus_window"] },
    # { key = "up", actions = ["prev_ft_entry"] },
    # { key = "down", actions = ["next_ft_entry"] },
    # { key = "btab", actions = ["prev_ft_entry"] },
    # { key = "tab", actions = ["next_ft_entry"] },
    # { key = "p", actions = ["select_ft_parent"] },
    # { key = "s", actions = ["ft_goto_current_file"] },
    # { key = "alt+1", actions = ["focus_window"] },
    # { key = "alt+2", actions = ["close_filetree"] },
    # { key = "alt+3", actions = ["show_locations"] },
]

[keymaps.prompt]
maps = [
    { key = "esc", actions = ["prompt_close"] },
    { key = "backspace", actions = ["prompt_remove_grapheme_before_cursor"] },
    { key = "left", actions = ["prompt_prev_grapheme"] },
    { key = "right", actions = ["prompt_next_grapheme"] },
    { key = "tab", actions = ["prompt_next_completion"] },
    { key = "btab", actions = ["prompt_prev_completion"] },
    { key = "enter", actions = ["prompt_confirm"] },
    { key = "up", actions = ["prompt_history_next"] },
    { key = "down", actions = ["prompt_history_prev"] },
]

[keymaps.completion]
fallthrough = "window"
maps = [
    { key = "tab", actions = ["completion_next"] },
    { key = "btab", actions = ["completion_prev"] },
    { key = "enter", actions = ["completion_confirm"] },
    { key = "esc", actions = ["completion_abort"] },
]
